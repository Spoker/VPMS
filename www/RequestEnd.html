<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=yes, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
        <title>Request End</title>        
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="css/index.css">
        <!--<link rel="stylesheet" href="css/font-awesome.css">-->
        <style type="text/css">
            #container
            {
                top: 30%;
                position: fixed;
                width: 100%;
                font-family: 'Lucida Console';
            }
            .headerbar
            {
                top: 0;
                left: 0;
                margin: 0;
                position: absolute;
            }
            #btnClose{
                top: 3%;
                position: absolute;
                float: right;
                right: 2%;
                height: 25px;
            }
        </style>
    </head>
    <body onload="onLoad()">
        <a id="btnClose" href="#" onclick="exitFromApp()"><img alt="close" src="img/Close24x24.PNG" height="25" width="25"></a>
        <img alt="header bar" class="headerbar" src="img/headerbar.png" width="100%" height="5px">
        <div id="container" class="container text-center">
            <img alt="header logo" class="logo" src="img/logo.png" height="100" width="100"><br><br>
            <span class="text-success">Success: </span> Your Visit Request submitted successfully.<br> Status information will be sent to<strong><code><span id="mail"></span></code></strong>
        </div>
        <footer>
            <div class="container text-center">
                <small><span class="text-primary">Â© <script>document.write(new Date().getFullYear())</script> - KRISHNAPATNAM PORT COMPANY LTD.</span></small>
            </div>
        </footer>
        <script type="text/ecmascript" src="bootstrap/js/bootstrap.min.js"></script>
        <script type="text/ecmascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript">
            var qsParm = new Array();
            var Email = null;
            var ReqId = null;

            function onLoad() {
                document.addEventListener("deviceready", onDeviceReady, false);
            }

            // device APIs are available
            //
            function onDeviceReady() {
                // Register the event listener
                document.addEventListener("backbutton", onBackKeyDown, false);
            }

            // Handle the back button
            //
            function onBackKeyDown() {
            }

            function isPhoneGap() {
                return (window.cordova || window.PhoneGap || window.phonegap)
                && /^file:\/{3}[^\/]/i.test(window.location.href)
                && /ios|iphone|ipod|ipad|android/i.test(navigator.userAgent);
            }

            function qs() {
                var query = window.location.search.substring(1);
                var parms = query.split('&');
                for (var i = 0; i < parms.length; i++) {
                    var pos = parms[i].indexOf('=');
                    if (pos > 0) {
                        var key = parms[i].substring(0, pos);
                        var val = parms[i].substring(pos + 1);
                        qsParm[key] = val;
                    }
                }
                if (parms.length > 1) {
                    $("#mail").text(qsParm["mail"]);
                    ReqId = qsParm["reqid"];
                    return true;
                }
                else {
                    window.location.href = 'VisitorRequest.html';
                    return false;
                }
            }

            /*document.addEventListener('DOMContentLoaded', loaded, false);*/
            function exitFromApp() {
                var success = function (status) {
                    alert('Message: ' + status);
                }
                var error = function (status) {
                    alert('Error: ' + status);
                }
                window.cache.clear(success, error);
                navigator.app.exitApp();
            }
            /*
            document.addEventListener('deviceready', onDeviceReady);
            function onDeviceReady()
            {
            var success = function(status) {
            alert('Message: ' + status);
            }
            var error = function(status) {
            alert('Error: ' + status);
            }
            window.cache.clear( success, error );
            }
            */
            $(document).ready(function () {
                qs();

                /*setTimeout(exitFromApp(), 5000);*/
                if (isPhoneGap()) {
                    $("#btnClose").show();
                } else {
                    $("#btnClose").hide();
                }
                if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                    $("#btnClose").hide();
                }
            });
        </script>
    </body>
</html>